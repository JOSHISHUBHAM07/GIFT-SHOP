import{c as j,r as o,j as t,o as k,L as f,a as C,u as d}from"./index-L5qlGLpf.js";import{u as N,f as L,L as p,m,B as g,s as w}from"./supabaseClient-DQzvhkAx.js";import{u as I,H as R,P as S}from"./CartDrawer-BNY1Fyqk.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=j("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]),P=o.createContext(null);function G(){const e=o.useRef(!1);return N(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function z(){const e=G(),[r,a]=o.useState(0),s=o.useCallback(()=>{e.current&&a(r+1)},[r]);return[o.useCallback(()=>L.postRender(s),[s]),r]}const E=e=>!e.isLayoutDirty&&e.willUpdate(!1);function v(){const e=new Set,r=new WeakMap,a=()=>e.forEach(E);return{add:s=>{e.add(s),r.set(s,s.addEventListener("willUpdate",a))},remove:s=>{e.delete(s);const n=r.get(s);n&&(n(),r.delete(s)),a()},dirty:a}}const b=e=>e===!0,H=e=>b(e===!0)||e==="id",q=({children:e,id:r,inherit:a=!0})=>{const s=o.useContext(p),n=o.useContext(P),[u,h]=z(),l=o.useRef(null),c=s.id||n;l.current===null&&(H(a)&&c&&(r=r?c+"-"+r:c),l.current={id:r,group:b(a)&&s.group||v()});const i=o.useMemo(()=>({...l.current,forceRender:u}),[h]);return t.jsx(p.Provider,{value:i,children:e})},A=({product:e,index:r=0})=>{const{addItem:a,openCart:s}=I(),[n,u]=o.useState(!1),h=k(),l=i=>{i.preventDefault(),i.stopPropagation(),a({...e,quantity:1}),d.success(`${e.name} added to cart`),s()},c=async i=>{i.preventDefault(),i.stopPropagation();const{data:{session:y}}=await w.auth.getSession();if(!y){d.error("Please login to save items"),h("/auth");return}u(!0);try{const{error:x}=await w.from("wishlist").insert([{user_id:y.user.id,product_id:e.id}]);if(x)if(x.code==="23505")d("Item already in wishlist");else throw x;else d.success("Saved to wishlist! ❤️")}catch{d.error("Error saving item")}finally{u(!1)}};return t.jsx(m.div,{initial:{opacity:0,y:40},whileInView:{opacity:1,y:0},viewport:{once:!0,margin:"-50px"},transition:{duration:.6,delay:r*.1},className:"group",children:t.jsxs(m.div,{className:"card-product relative rounded-2xl overflow-hidden bg-card border border-white/5 shadow-lg",whileHover:{y:-8},transition:{duration:.4},children:[t.jsxs("div",{className:"relative aspect-square overflow-hidden bg-muted",children:[t.jsx(f,{to:`/product/${e.id}`,children:t.jsx(m.img,{src:e.image,alt:e.name,className:"w-full h-full object-cover",whileHover:{scale:1.08},transition:{duration:.6}})}),t.jsx(m.div,{className:"absolute top-4 right-4 z-20",children:t.jsx(g,{size:"icon",variant:"secondary",className:"rounded-full shadow-lg bg-black/40 backdrop-blur-md text-white hover:bg-red-500 hover:text-white border-none h-10 w-10 transition-colors",onClick:c,disabled:n,children:n?t.jsx(C,{className:"h-4 w-4 animate-spin"}):t.jsx(R,{className:"h-4 w-4"})})}),t.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-4 z-20 overflow-hidden",children:t.jsx("div",{className:"translate-y-full group-hover:translate-y-0 transition-transform duration-300 ease-out",children:t.jsxs(g,{className:"w-full rounded-full bg-primary text-white hover:bg-primary/90 shadow-lg h-12 font-medium",onClick:l,children:[t.jsx(S,{className:"h-4 w-4 mr-2"}),"Quick Add"]})})})]}),t.jsxs(f,{to:`/product/${e.id}`,className:"block p-5",children:[t.jsx("p",{className:"text-xs text-muted-foreground uppercase tracking-wider mb-1",children:e.category}),t.jsx("h3",{className:"font-display text-lg font-medium text-foreground truncate",children:e.name}),t.jsx("div",{className:"flex items-center gap-2 mt-2",children:t.jsxs("span",{className:"text-foreground font-semibold text-lg",children:["$",e.price.toFixed(2)]})})]})]})})};export{q as L,A as P,$ as S};
