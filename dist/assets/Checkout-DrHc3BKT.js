import{c as w,o as v,r as p,j as e,L as C,a as L,u}from"./index-L5qlGLpf.js";import{B as F,s as g}from"./supabaseClient-DQzvhkAx.js";import{I as a}from"./input-BFLFz7Wl.js";import{L as t}from"./label-ChehKa78.js";import{u as q}from"./CartDrawer-BNY1Fyqk.js";import{L as S}from"./Layout-DBUk0RNB.js";import{C as k}from"./chevron-left-CEsZ4Lps.js";import{L as P}from"./lock-nzVra7Gp.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=w("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),T=()=>{const j=v(),{items:l,totalPrice:c,clearCart:b}=q(),[n,m]=p.useState(!1),[d,f]=p.useState({email:"",name:"",address:"",city:"",zip:"",cardNumber:"",expiry:"",cvc:""}),N=async r=>{if(r.preventDefault(),l.length!==0){m(!0),await new Promise(i=>setTimeout(i,2e3));try{const{data:i,error:h}=await g.from("orders").insert([{customer_name:d.name,email:d.email,address:d.address,city:d.city,zip:d.zip,total_amount:c(),status:"paid"}]).select().single();if(h)throw h;const y=l.map(o=>({order_id:i.id,product_id:o.id,quantity:o.quantity,price_at_purchase:o.price})),{error:x}=await g.from("order_items").insert(y);if(x)throw x;u.success("Payment Successful! ðŸŽ‰",{description:`Order #${i.id} has been confirmed.`}),b(),j("/account")}catch(i){console.error(i),u.error(i.message||"Failed to place order")}finally{m(!1)}}},s=r=>{f({...d,[r.target.id]:r.target.value})};return e.jsx(S,{children:e.jsxs("div",{className:"container mx-auto px-4 py-12 max-w-6xl",children:[e.jsxs(C,{to:"/",className:"inline-flex items-center text-sm text-muted-foreground hover:text-primary mb-8 transition-colors",children:[e.jsx(k,{className:"w-4 h-4 mr-1"})," Back to Shop"]}),e.jsx("h1",{className:"font-display text-4xl font-bold mb-8 text-gradient",children:"Secure Checkout"}),e.jsxs("div",{className:"grid lg:grid-cols-2 gap-12",children:[e.jsxs("form",{onSubmit:N,className:"space-y-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Shipping Details"}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(t,{htmlFor:"name",children:"Full Name"}),e.jsx(a,{id:"name",required:!0,onChange:s,className:"bg-white/5 border-white/10",placeholder:"John Doe"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(t,{htmlFor:"email",children:"Email Address"}),e.jsx(a,{id:"email",type:"email",required:!0,onChange:s,className:"bg-white/5 border-white/10",placeholder:"john@example.com"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(t,{htmlFor:"address",children:"Street Address"}),e.jsx(a,{id:"address",required:!0,onChange:s,className:"bg-white/5 border-white/10",placeholder:"123 Gift Lane"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(t,{htmlFor:"city",children:"City"}),e.jsx(a,{id:"city",required:!0,onChange:s,className:"bg-white/5 border-white/10",placeholder:"New York"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(t,{htmlFor:"zip",children:"ZIP Code"}),e.jsx(a,{id:"zip",required:!0,onChange:s,className:"bg-white/5 border-white/10",placeholder:"10001"})]})]})]})]}),e.jsxs("div",{className:"space-y-4 pt-6 border-t border-white/10",children:[e.jsxs("h3",{className:"text-xl font-semibold flex items-center gap-2",children:[e.jsx(D,{className:"w-5 h-5 text-primary"})," Payment Method"]}),e.jsxs("div",{className:"grid gap-4 p-6 rounded-xl bg-white/5 border border-white/10",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(t,{htmlFor:"cardNumber",children:"Card Number"}),e.jsx(a,{id:"cardNumber",placeholder:"0000 0000 0000 0000",maxLength:19,required:!0,onChange:s,className:"bg-black/20 border-white/10 font-mono"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(t,{htmlFor:"expiry",children:"Expiry Date"}),e.jsx(a,{id:"expiry",placeholder:"MM/YY",maxLength:5,required:!0,onChange:s,className:"bg-black/20 border-white/10 font-mono"})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(t,{htmlFor:"cvc",children:"CVC"}),e.jsx(a,{id:"cvc",placeholder:"123",maxLength:3,type:"password",required:!0,onChange:s,className:"bg-black/20 border-white/10 font-mono"})]})]})]})]}),e.jsx(F,{type:"submit",size:"lg",className:"w-full btn-primary h-14 text-lg",disabled:n,children:n?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{className:"animate-spin"})," Processing Payment..."]}):`Pay $${c().toFixed(2)}`}),e.jsxs("p",{className:"text-xs text-center text-muted-foreground flex items-center justify-center gap-2",children:[e.jsx(P,{className:"w-3 h-3"})," SSL Encrypted Transaction"]})]}),e.jsxs("div",{className:"glass rounded-2xl p-8 h-fit",children:[e.jsx("h3",{className:"text-xl font-semibold mb-6 border-b border-white/10 pb-4",children:"Order Summary"}),e.jsx("div",{className:"space-y-4 max-h-[300px] overflow-y-auto pr-2 custom-scrollbar",children:l.map(r=>e.jsxs("div",{className:"flex justify-between items-center text-sm group",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"relative w-12 h-12 rounded overflow-hidden bg-white/5",children:e.jsx("img",{src:r.image,className:"w-full h-full object-cover",alt:r.name})}),e.jsxs("span",{children:[r.name," ",e.jsxs("span",{className:"text-muted-foreground ml-1",children:["x",r.quantity]})]})]}),e.jsxs("span",{children:["$",(r.price*r.quantity).toFixed(2)]})]},r.id))}),e.jsxs("div",{className:"border-t border-white/10 mt-6 pt-4 flex justify-between font-bold text-lg text-primary",children:[e.jsx("span",{children:"Total"}),e.jsxs("span",{children:["$",c().toFixed(2)]})]})]})]})]})})};export{T as default};
